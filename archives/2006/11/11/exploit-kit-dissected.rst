author: Marcin
disqus_id: 9c7bba1e-a600-4542-a678-a523994c9957
disqus_url: http://www.tssci-security.com/archives/2006/11/11/exploit-kit-dissected/
mod_date: 2006-11-12 17:06:30
parent: 0
post_id: 78
post_type: post
pub_date: 2006-11-11 04:20:37
public: 'yes'
slug: exploit-kit-dissected
tags:
- security
template: post.html
title: Exploit kit dissected

Exploit kit dissected
#####################

Alex Rice of Websense Security Labs, `dissected
"Web-Attacker" <http://www.websense.com/securitylabs/blog/blog.php?BlogID=94>`_,
one of the most popular exploit kits on the web. He recently got a hold
of the source code and takes us step by step through it all. For those
who do not know how Web-Attacker works, here's a brief scenario:

    #. User visits a compromised webpage containing a hidden iframe that
       loads *go.php*.
    #. *go.php* redirects to *ie0609.cgi?homepage*, which redirects to
       *demo.php*.
    #. Obfuscated JavaScript from *demo.php* determines which exploit
       should be attempted and redirects to
       *ie0609.cgi?type=<EXPLOIT\_TYPE>*.
    #. Based on the value of the *type* parameter, *ie0609.cgi* returns
       the requested exploit. Each exploit differs but attempts the same
       action: execute the data downloaded from
       *ie0609.cgi?exploit=*\ *<EXPLOIT\_TYPE>*\ *.*
    #. With the *exploit* parameter, *ie0609.cgi* returns the malicious
       binary to be executed. The attack is complete.

Be sure to check out the blog post and see how this simple, yet
nasty little Perl script works.
